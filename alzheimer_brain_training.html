<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§è„‘è®­ç»ƒ - é˜¿å°”èŒ¨æµ·é»˜ç—‡é¢„é˜²æ¸¸æˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
        }

        .container {
            max-width: 800px;
            width: 90%;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        h1 {
            color: #4a5568;
            margin-bottom: 30px;
            font-size: 2.5em;
            font-weight: bold;
        }

        .game-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .game-btn {
            background: linear-gradient(135deg, #ff6b6b, #ffd93d);
            border: none;
            border-radius: 15px;
            padding: 20px;
            color: white;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .game-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .game-btn.memory { background: linear-gradient(135deg, #667eea, #764ba2); }
        .game-btn.attention { background: linear-gradient(135deg, #f093fb, #f5576c); }
        .game-btn.logic { background: linear-gradient(135deg, #4facfe, #00f2fe); }
        .game-btn.calculation { background: linear-gradient(135deg, #43e97b, #38f9d7); }

        .game-area {
            display: none;
            min-height: 400px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            margin-top: 20px;
        }

        .game-area.active {
            display: block;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            background: rgba(102, 126, 234, 0.1);
            padding: 15px;
            border-radius: 10px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }

        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            max-width: 400px;
            margin: 0 auto;
        }

        .memory-card {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .memory-card:hover {
            transform: scale(1.05);
        }

        .memory-card.flipped {
            background: #fff;
            color: #333;
            border: 2px solid #667eea;
        }

        .memory-card.matched {
            background: #43e97b;
            color: white;
            transform: scale(0.9);
        }

        .number-sequence {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .number-btn {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, #ff6b6b, #ffd93d);
            color: white;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .number-btn:hover {
            transform: scale(1.1);
        }

        .number-btn.highlight {
            background: linear-gradient(135deg, #43e97b, #38f9d7);
            animation: pulse 0.5s ease-in-out;
        }

        .number-btn.selected {
            background: linear-gradient(135deg, #667eea, #764ba2);
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .back-btn {
            background: #718096;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            margin: 20px 0;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: #4a5568;
            transform: translateY(-2px);
        }

        .instruction {
            background: rgba(102, 126, 234, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 1.1em;
            line-height: 1.5;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e2e8f0;
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            transition: width 0.3s ease;
        }

        .calculation-area {
            font-size: 1.5em;
            margin: 20px 0;
        }

        .calculation-input {
            font-size: 1.2em;
            padding: 10px;
            border: 2px solid #667eea;
            border-radius: 10px;
            margin: 10px;
            text-align: center;
            width: 100px;
        }

        .pattern-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-width: 300px;
            margin: 0 auto;
        }

        .pattern-cell {
            aspect-ratio: 1;
            border: 2px solid #667eea;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pattern-cell.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .pattern-cell.user-selected {
            background: linear-gradient(135deg, #43e97b, #38f9d7);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§  å¤§è„‘è®­ç»ƒæ¸¸æˆ</h1>
        <p style="margin-bottom: 30px; font-size: 1.1em; color: #666;">
            é€šè¿‡ç§‘å­¦è®¾è®¡çš„è®¤çŸ¥è®­ç»ƒæ¸¸æˆï¼Œå¸®åŠ©é¢„é˜²é˜¿å°”èŒ¨æµ·é»˜ç—‡ï¼Œæå‡å¤§è„‘å¥åº·
        </p>

        <div id="main-menu" class="game-selection">
            <button class="game-btn memory" onclick="startGame('memory')">
                ğŸ§© è®°å¿†åŠ›è®­ç»ƒ<br>
                <small>è®°å¿†å¡ç‰‡é…å¯¹</small>
            </button>
            <button class="game-btn attention" onclick="startGame('attention')">
                ğŸ‘ï¸ æ³¨æ„åŠ›è®­ç»ƒ<br>
                <small>æ•°å­—åºåˆ—è®°å¿†</small>
            </button>
            <button class="game-btn logic" onclick="startGame('logic')">
                ğŸ§® é€»è¾‘æ¨ç†<br>
                <small>å›¾æ¡ˆè¯†åˆ«</small>
            </button>
            <button class="game-btn calculation" onclick="startGame('calculation')">
                ğŸ”¢ è®¡ç®—èƒ½åŠ›<br>
                <small>å¿ƒç®—è®­ç»ƒ</small>
            </button>
        </div>

        <div class="stats">
            <div class="stat-item">
                <div class="stat-value" id="total-score">0</div>
                <div>æ€»åˆ†</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="games-played">0</div>
                <div>æ¸¸æˆæ¬¡æ•°</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="streak">0</div>
                <div>è¿èƒœæ¬¡æ•°</div>
            </div>
        </div>

        <!-- è®°å¿†åŠ›æ¸¸æˆ -->
        <div id="memory-game" class="game-area">
            <button class="back-btn" onclick="backToMenu()">è¿”å›ä¸»èœå•</button>
            <div class="instruction">
                ç‚¹å‡»å¡ç‰‡æ‰¾åˆ°ç›¸åŒçš„é…å¯¹ã€‚é”»ç‚¼çŸ­æœŸè®°å¿†å’Œè§†è§‰è®°å¿†èƒ½åŠ›ã€‚
            </div>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="memory-moves">0</div>
                    <div>æ­¥æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="memory-matches">0</div>
                    <div>é…å¯¹æ•°</div>
                </div>
            </div>
            <div class="memory-grid" id="memory-grid"></div>
            <button class="game-btn" onclick="resetMemoryGame()" style="margin-top: 20px;">é‡æ–°å¼€å§‹</button>
        </div>

        <!-- æ³¨æ„åŠ›æ¸¸æˆ -->
        <div id="attention-game" class="game-area">
            <button class="back-btn" onclick="backToMenu()">è¿”å›ä¸»èœå•</button>
            <div class="instruction">
                è§‚å¯Ÿæ•°å­—åºåˆ—çš„é—ªçƒé¡ºåºï¼Œç„¶åæŒ‰ç…§ç›¸åŒé¡ºåºç‚¹å‡»æ•°å­—ã€‚
            </div>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="attention-level">1</div>
                    <div>å…³å¡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="sequence-length">3</div>
                    <div>åºåˆ—é•¿åº¦</div>
                </div>
            </div>
            <div class="number-sequence" id="number-sequence"></div>
            <div id="attention-status" style="margin: 20px 0; font-size: 1.2em; font-weight: bold;"></div>
            <button class="game-btn" onclick="startAttentionRound()" id="attention-start-btn">å¼€å§‹æ¸¸æˆ</button>
        </div>

        <!-- é€»è¾‘æ¨ç†æ¸¸æˆ -->
        <div id="logic-game" class="game-area">
            <button class="back-btn" onclick="backToMenu()">è¿”å›ä¸»èœå•</button>
            <div class="instruction">
                è§‚å¯Ÿå›¾æ¡ˆè§„å¾‹ï¼Œç„¶åå¤åˆ¶ç›¸åŒçš„å›¾æ¡ˆã€‚é”»ç‚¼ç©ºé—´è®°å¿†å’Œé€»è¾‘æ€ç»´ã€‚
            </div>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="logic-level">1</div>
                    <div>å…³å¡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="pattern-score">0</div>
                    <div>åˆ†æ•°</div>
                </div>
            </div>
            <div style="display: flex; justify-content: space-around; align-items: center; margin: 20px 0;">
                <div>
                    <h3>ç›®æ ‡å›¾æ¡ˆ</h3>
                    <div class="pattern-grid" id="target-pattern"></div>
                </div>
                <div>
                    <h3>ä½ çš„å›¾æ¡ˆ</h3>
                    <div class="pattern-grid" id="user-pattern"></div>
                </div>
            </div>
            <button class="game-btn" onclick="checkPattern()">æ£€æŸ¥ç­”æ¡ˆ</button>
            <button class="game-btn" onclick="newLogicPattern()" style="margin-left: 10px;">ä¸‹ä¸€é¢˜</button>
        </div>

        <!-- è®¡ç®—èƒ½åŠ›æ¸¸æˆ -->
        <div id="calculation-game" class="game-area">
            <button class="back-btn" onclick="backToMenu()">è¿”å›ä¸»èœå•</button>
            <div class="instruction">
                å¿«é€Ÿè®¡ç®—æ•°å­¦é¢˜ç›®ï¼Œé”»ç‚¼æ•°å­—å¤„ç†å’Œå·¥ä½œè®°å¿†èƒ½åŠ›ã€‚
            </div>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="calc-correct">0</div>
                    <div>æ­£ç¡®</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="calc-wrong">0</div>
                    <div>é”™è¯¯</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="calc-time">60</div>
                    <div>å‰©ä½™æ—¶é—´</div>
                </div>
            </div>
            <div class="calculation-area">
                <div id="calculation-problem">å‡†å¤‡å¼€å§‹è®¡ç®—è®­ç»ƒ</div>
                <input type="number" id="calculation-input" class="calculation-input" placeholder="ç­”æ¡ˆ">
                <button class="game-btn" onclick="checkCalculation()">æäº¤</button>
            </div>
            <button class="game-btn" onclick="startCalculationGame()">å¼€å§‹è®¡ç®—æ¸¸æˆ</button>
        </div>
    </div>

    <script>
        // æ¸¸æˆæ•°æ®
        let gameStats = {
            totalScore: 0,
            gamesPlayed: 0,
            streak: 0
        };

        // è®°å¿†åŠ›æ¸¸æˆ
        let memoryGame = {
            cards: [],
            flippedCards: [],
            moves: 0,
            matches: 0
        };

        // æ³¨æ„åŠ›æ¸¸æˆ
        let attentionGame = {
            sequence: [],
            userSequence: [],
            level: 1,
            isShowingSequence: false
        };

        // é€»è¾‘æ¨ç†æ¸¸æˆ
        let logicGame = {
            targetPattern: [],
            userPattern: [],
            level: 1,
            score: 0
        };

        // è®¡ç®—æ¸¸æˆ
        let calculationGame = {
            currentProblem: null,
            correct: 0,
            wrong: 0,
            timeLeft: 60,
            timer: null
        };

        // ä¸»èœå•åŠŸèƒ½
        function startGame(gameType) {
            document.getElementById('main-menu').style.display = 'none';
            document.querySelectorAll('.game-area').forEach(area => {
                area.classList.remove('active');
            });
            document.getElementById(gameType + '-game').classList.add('active');

            switch(gameType) {
                case 'memory':
                    initMemoryGame();
                    break;
                case 'attention':
                    initAttentionGame();
                    break;
                case 'logic':
                    initLogicGame();
                    break;
                case 'calculation':
                    initCalculationGame();
                    break;
            }
        }

        function backToMenu() {
            document.getElementById('main-menu').style.display = 'grid';
            document.querySelectorAll('.game-area').forEach(area => {
                area.classList.remove('active');
            });
            // æ¸…ç†å®šæ—¶å™¨
            if (calculationGame.timer) {
                clearInterval(calculationGame.timer);
            }
        }

        function updateStats() {
            document.getElementById('total-score').textContent = gameStats.totalScore;
            document.getElementById('games-played').textContent = gameStats.gamesPlayed;
            document.getElementById('streak').textContent = gameStats.streak;
        }

        // è®°å¿†åŠ›æ¸¸æˆ
        function initMemoryGame() {
            const symbols = ['ğŸŒŸ', 'ğŸˆ', 'ğŸ¨', 'ğŸµ', 'ğŸŒ¸', 'ğŸ¦‹', 'ğŸ', 'ğŸ'];
            memoryGame.cards = [...symbols, ...symbols].sort(() => Math.random() - 0.5);
            memoryGame.flippedCards = [];
            memoryGame.moves = 0;
            memoryGame.matches = 0;
            
            const grid = document.getElementById('memory-grid');
            grid.innerHTML = '';
            
            memoryGame.cards.forEach((symbol, index) => {
                const card = document.createElement('button');
                card.className = 'memory-card';
                card.dataset.index = index;
                card.onclick = () => flipCard(index);
                grid.appendChild(card);
            });
            
            updateMemoryStats();
        }

        function flipCard(index) {
            if (memoryGame.flippedCards.length >= 2) return;
            if (memoryGame.flippedCards.includes(index)) return;
            
            const card = document.querySelector(`[data-index="${index}"]`);
            card.textContent = memoryGame.cards[index];
            card.classList.add('flipped');
            memoryGame.flippedCards.push(index);
            
            if (memoryGame.flippedCards.length === 2) {
                memoryGame.moves++;
                setTimeout(checkMatch, 1000);
            }
        }

        function checkMatch() {
            const [first, second] = memoryGame.flippedCards;
            const firstCard = document.querySelector(`[data-index="${first}"]`);
            const secondCard = document.querySelector(`[data-index="${second}"]`);
            
            if (memoryGame.cards[first] === memoryGame.cards[second]) {
                firstCard.classList.add('matched');
                secondCard.classList.add('matched');
                memoryGame.matches++;
                gameStats.totalScore += 10;
                
                if (memoryGame.matches === 8) {
                    gameStats.gamesPlayed++;
                    gameStats.streak++;
                    alert('æ­å–œå®Œæˆï¼æ‚¨çš„è®°å¿†åŠ›å¾ˆæ£’ï¼');
                    updateStats();
                }
            } else {
                firstCard.textContent = '';
                secondCard.textContent = '';
                firstCard.classList.remove('flipped');
                secondCard.classList.remove('flipped');
            }
            
            memoryGame.flippedCards = [];
            updateMemoryStats();
        }

        function updateMemoryStats() {
            document.getElementById('memory-moves').textContent = memoryGame.moves;
            document.getElementById('memory-matches').textContent = memoryGame.matches;
        }

        function resetMemoryGame() {
            initMemoryGame();
        }

        // æ³¨æ„åŠ›æ¸¸æˆ
        function initAttentionGame() {
            attentionGame.sequence = [];
            attentionGame.userSequence = [];
            attentionGame.level = 1;
            
            const container = document.getElementById('number-sequence');
            container.innerHTML = '';
            
            for (let i = 1; i <= 9; i++) {
                const btn = document.createElement('button');
                btn.className = 'number-btn';
                btn.textContent = i;
                btn.onclick = () => userClickNumber(i);
                container.appendChild(btn);
            }
            
            updateAttentionStats();
            document.getElementById('attention-status').textContent = 'ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"æ¥å¼€å§‹è®­ç»ƒ';
        }

        function startAttentionRound() {
            const sequenceLength = Math.min(3 + attentionGame.level - 1, 8);
            attentionGame.sequence = [];
            attentionGame.userSequence = [];
            attentionGame.isShowingSequence = true;
            
            // ç”Ÿæˆéšæœºåºåˆ—
            for (let i = 0; i < sequenceLength; i++) {
                attentionGame.sequence.push(Math.floor(Math.random() * 9) + 1);
            }
            
            document.getElementById('attention-status').textContent = 'è¯·è®°ä½é—ªçƒçš„æ•°å­—é¡ºåº';
            document.getElementById('attention-start-btn').style.display = 'none';
            
            // æ˜¾ç¤ºåºåˆ—
            showSequence(0);
        }

        function showSequence(index) {
            if (index >= attentionGame.sequence.length) {
                attentionGame.isShowingSequence = false;
                document.getElementById('attention-status').textContent = 'è¯·æŒ‰ç…§åˆšæ‰çš„é¡ºåºç‚¹å‡»æ•°å­—';
                return;
            }
            
            const number = attentionGame.sequence[index];
            const buttons = document.querySelectorAll('.number-btn');
            const btn = buttons[number - 1];
            
            btn.classList.add('highlight');
            setTimeout(() => {
                btn.classList.remove('highlight');
                setTimeout(() => showSequence(index + 1), 300);
            }, 600);
        }

        function userClickNumber(number) {
            if (attentionGame.isShowingSequence) return;
            
            // æ·»åŠ é€‰ä¸­æ•ˆæœ
            const buttons = document.querySelectorAll('.number-btn');
            const clickedBtn = buttons[number - 1];
            clickedBtn.classList.add('selected');
            
            // å»¶è¿Ÿç§»é™¤é€‰ä¸­æ•ˆæœ
            setTimeout(() => {
                clickedBtn.classList.remove('selected');
            }, 200);
            
            attentionGame.userSequence.push(number);
            
            // æ£€æŸ¥å½“å‰è¾“å…¥æ˜¯å¦æ­£ç¡®
            const currentIndex = attentionGame.userSequence.length - 1;
            if (attentionGame.userSequence[currentIndex] !== attentionGame.sequence[currentIndex]) {
                // æ¸…é™¤æ‰€æœ‰é€‰ä¸­çŠ¶æ€
                setTimeout(() => {
                    buttons.forEach(btn => btn.classList.remove('selected'));
                }, 200);
                document.getElementById('attention-status').textContent = 'é”™è¯¯ï¼é‡æ–°å¼€å§‹è¿™ä¸€å…³';
                setTimeout(() => {
                    document.getElementById('attention-start-btn').style.display = 'inline-block';
                    document.getElementById('attention-status').textContent = 'ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"æ¥é‡è¯•';
                }, 1500);
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦å®Œæˆåºåˆ—
            if (attentionGame.userSequence.length === attentionGame.sequence.length) {
                attentionGame.level++;
                gameStats.totalScore += attentionGame.level * 5;
                gameStats.gamesPlayed++;
                gameStats.streak++;
                
                document.getElementById('attention-status').textContent = `å¤ªæ£’äº†ï¼è¿›å…¥ç¬¬${attentionGame.level}å…³`;
                updateAttentionStats();
                updateStats();
                
                // å»¶è¿Ÿæ¸…é™¤é€‰ä¸­çŠ¶æ€å’Œæ˜¾ç¤ºä¸‹ä¸€å…³æŒ‰é’®
                setTimeout(() => {
                    buttons.forEach(btn => btn.classList.remove('selected'));
                    document.getElementById('attention-start-btn').style.display = 'inline-block';
                    document.getElementById('attention-status').textContent = 'ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"ç»§ç»­æŒ‘æˆ˜';
                }, 2000);
            }
        }

        function updateAttentionStats() {
            document.getElementById('attention-level').textContent = attentionGame.level;
            document.getElementById('sequence-length').textContent = Math.min(3 + attentionGame.level - 1, 8);
        }

        // é€»è¾‘æ¨ç†æ¸¸æˆ
        function initLogicGame() {
            logicGame.level = 1;
            logicGame.score = 0;
            createPatternGrids();
            newLogicPattern();
            updateLogicStats();
        }

        function createPatternGrids() {
            const targetGrid = document.getElementById('target-pattern');
            const userGrid = document.getElementById('user-pattern');
            
            targetGrid.innerHTML = '';
            userGrid.innerHTML = '';
            
            for (let i = 0; i < 9; i++) {
                const targetCell = document.createElement('div');
                targetCell.className = 'pattern-cell';
                targetGrid.appendChild(targetCell);
                
                const userCell = document.createElement('div');
                userCell.className = 'pattern-cell';
                userCell.onclick = () => toggleUserCell(i);
                userGrid.appendChild(userCell);
            }
        }

        function newLogicPattern() {
            // é‡ç½®ç”¨æˆ·å›¾æ¡ˆ
            logicGame.userPattern = new Array(9).fill(false);
            const userCells = document.querySelectorAll('#user-pattern .pattern-cell');
            userCells.forEach(cell => cell.classList.remove('user-selected'));
            
            // ç”Ÿæˆæ–°çš„ç›®æ ‡å›¾æ¡ˆ
            const complexity = Math.min(3 + logicGame.level, 7);
            logicGame.targetPattern = new Array(9).fill(false);
            
            // éšæœºæ¿€æ´»ä¸€äº›æ ¼å­
            const activeCells = [];
            while (activeCells.length < complexity) {
                const index = Math.floor(Math.random() * 9);
                if (!activeCells.includes(index)) {
                    activeCells.push(index);
                    logicGame.targetPattern[index] = true;
                }
            }
            
            // æ˜¾ç¤ºç›®æ ‡å›¾æ¡ˆ
            const targetCells = document.querySelectorAll('#target-pattern .pattern-cell');
            targetCells.forEach((cell, index) => {
                if (logicGame.targetPattern[index]) {
                    cell.classList.add('active');
                } else {
                    cell.classList.remove('active');
                }
            });
        }

        function toggleUserCell(index) {
            logicGame.userPattern[index] = !logicGame.userPattern[index];
            const cell = document.querySelectorAll('#user-pattern .pattern-cell')[index];
            
            if (logicGame.userPattern[index]) {
                cell.classList.add('user-selected');
            } else {
                cell.classList.remove('user-selected');
            }
        }

        function checkPattern() {
            let correct = true;
            for (let i = 0; i < 9; i++) {
                if (logicGame.targetPattern[i] !== logicGame.userPattern[i]) {
                    correct = false;
                    break;
                }
            }
            
            if (correct) {
                logicGame.level++;
                logicGame.score += logicGame.level * 10;
                gameStats.totalScore += logicGame.level * 10;
                gameStats.gamesPlayed++;
                gameStats.streak++;
                alert(`æ­£ç¡®ï¼è¿›å…¥ç¬¬${logicGame.level}å…³`);
                newLogicPattern();
            } else {
                alert('ä¸æ­£ç¡®ï¼Œè¯·å†è¯•è¯•');
                gameStats.streak = 0;
            }
            
            updateLogicStats();
            updateStats();
        }

        function updateLogicStats() {
            document.getElementById('logic-level').textContent = logicGame.level;
            document.getElementById('pattern-score').textContent = logicGame.score;
        }

        // è®¡ç®—èƒ½åŠ›æ¸¸æˆ
        function initCalculationGame() {
            calculationGame.correct = 0;
            calculationGame.wrong = 0;
            calculationGame.timeLeft = 60;
            updateCalculationStats();
            document.getElementById('calculation-problem').textContent = 'å‡†å¤‡å¼€å§‹è®¡ç®—è®­ç»ƒ';
            document.getElementById('calculation-input').value = '';
        }

        function startCalculationGame() {
            calculationGame.timeLeft = 60;
            calculationGame.correct = 0;
            calculationGame.wrong = 0;
            
            // å¼€å§‹è®¡æ—¶
            calculationGame.timer = setInterval(() => {
                calculationGame.timeLeft--;
                updateCalculationStats();
                
                if (calculationGame.timeLeft <= 0) {
                    clearInterval(calculationGame.timer);
                    gameStats.gamesPlayed++;
                    gameStats.totalScore += calculationGame.correct * 5;
                    updateStats();
                    alert(`æ—¶é—´åˆ°ï¼æ‚¨ç­”å¯¹äº†${calculationGame.correct}é¢˜ï¼Œç­”é”™äº†${calculationGame.wrong}é¢˜`);
                    initCalculationGame();
                    return;
                }
            }, 1000);
            
            generateCalculationProblem();
        }

        function generateCalculationProblem() {
            const operations = ['+', '-', 'Ã—'];
            const operation = operations[Math.floor(Math.random() * operations.length)];
            
            let a, b, answer;
            
            switch(operation) {
                case '+':
                    a = Math.floor(Math.random() * 50) + 1;
                    b = Math.floor(Math.random() * 50) + 1;
                    answer = a + b;
                    break;
                case '-':
                    a = Math.floor(Math.random() * 50) + 20;
                    b = Math.floor(Math.random() * (a - 1)) + 1;
                    answer = a - b;
                    break;
                case 'Ã—':
                    a = Math.floor(Math.random() * 12) + 1;
                    b = Math.floor(Math.random() * 12) + 1;
                    answer = a * b;
                    break;
            }
            
            calculationGame.currentProblem = {
                question: `${a} ${operation} ${b} = ?`,
                answer: answer
            };
            
            document.getElementById('calculation-problem').textContent = calculationGame.currentProblem.question;
            document.getElementById('calculation-input').value = '';
            document.getElementById('calculation-input').focus();
        }

        function checkCalculation() {
            if (!calculationGame.currentProblem) return;
            
            const userAnswer = parseInt(document.getElementById('calculation-input').value);
            
            if (userAnswer === calculationGame.currentProblem.answer) {
                calculationGame.correct++;
                gameStats.streak++;
            } else {
                calculationGame.wrong++;
                gameStats.streak = 0;
            }
            
            updateCalculationStats();
            
            if (calculationGame.timeLeft > 0) {
                generateCalculationProblem();
            }
        }

        function updateCalculationStats() {
            document.getElementById('calc-correct').textContent = calculationGame.correct;
            document.getElementById('calc-wrong').textContent = calculationGame.wrong;
            document.getElementById('calc-time').textContent = calculationGame.timeLeft;
        }

        // é”®ç›˜äº‹ä»¶
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && document.getElementById('calculation-game').classList.contains('active')) {
                checkCalculation();
            }
        });

        // åˆå§‹åŒ–ç»Ÿè®¡
        updateStats();
    </script>
</body>
</html>